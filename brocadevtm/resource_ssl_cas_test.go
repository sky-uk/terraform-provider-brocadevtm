package brocadevtm

import (
	"fmt"
	"github.com/hashicorp/terraform/helper/acctest"
	"github.com/hashicorp/terraform/helper/resource"
	"github.com/hashicorp/terraform/terraform"
	"github.com/sky-uk/go-brocade-vtm/api"
	"regexp"
	"testing"
)

func TestAccBrocadeVTMSSLCasBasic(t *testing.T) {

	randomInt := acctest.RandInt()
	sslCasConfigName := fmt.Sprintf("acctest_brocadevtm_ssl_cas_file-%d", randomInt)
	sslCasConfigResourceName := "brocadevtm_ssl_cas_file.acctest"
	sslServerKeyName := fmt.Sprintf("acctest_brocadevtm_ssl_cas_file-%d", randomInt)

	fmt.Printf("\n\nSSL cas config file is %s.\n\n", sslCasConfigName)

	resource.Test(t, resource.TestCase{
		PreCheck: func() {
			testAccPreCheck(t)
		},
		Providers: testAccProviders,
		CheckDestroy: func(state *terraform.State) error {
			return testAccBrocadeVTMSSLCasConfigCheckDestroy(state, sslCasConfigName)
		},
		Steps: []resource.TestStep{
			{
				Config:      testAccBrocadeVTMSSLCasConfigNoNameTemplate(),
				ExpectError: regexp.MustCompile(`required field is not set`),
			},
			{
				Config: testAccBrocadeSSLCasConfigCreateTemplate(sslCasConfigName, sslServerKeyName),
				Check: resource.ComposeTestCheckFunc(
					testAccBrocadeVTMSSLCasConfigExists(sslCasConfigName, sslCasConfigResourceName),
					resource.TestCheckResourceAttr(sslCasConfigResourceName, "name", sslCasConfigName),
					resource.TestCheckResourceAttr(sslCasConfigResourceName, "ssl_cas_config", "-----BEGIN CERTIFICATE-----\n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\nX6StyGpgITVFXnNg98fVzQ0=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIF7jCCA9agAwIBAgIJAIqYpYx6bXGmMA0GCSqGSIb3DQEBCwUAMIGDMQswCQYD\nVQQGEwJHQjEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9uMRAwDgYD\nVQQKDAdFeGFtcGxlMQswCQYDVQQLDAJFRzEQMA4GA1UEAwwHZXhhbXBsZTEgMB4G\nCSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhvc3QwHhcNMTcxMDE5MTAyNzMyWhcN\nMzcxMDE0MTAyNzMyWjCBgzELMAkGA1UEBhMCR0IxEDAOBgNVBAgMB0VuZ2xhbmQx\nDzANBgNVBAcMBkxvbmRvbjEQMA4GA1UECgwHRXhhbXBsZTELMAkGA1UECwwCRUcx\nEDAOBgNVBAMMB2V4YW1wbGUxIDAeBgkqhkiG9w0BCQEWEWV4YW1wbGVAbG9jYWxo\nb3N0MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAueVIz2gitbIfux+G\nTlpawaauocuYlEh4VyhOyI78aRpAVhV1YRYuPGJXPji+3xO+0ThkEPDG8sWlliq5\nV6wOcYIZzjGTHYQwkJJxZXGfeOt/J6cio9TORcuLH8FtA8UeR0/HovsJ30YelPB1\nT950FZIOriFk1U3+ty9JF8crqiFOf93TNcldLXCrtKz6KXZeR/GPMkLMHszuMeyJ\ndqtrmWxhOiDwD33K1fpYZKoFJf1CMCNmDD4c0uGDKHUbu7T21JoqiwEImUsWWkyi\nUTDZk17XDbPBXFYUI2v9AimPvpiE+xXpDKGXIUHyTCExgvIiAGZ3neBeEyRrBTdu\nPpKnulXTXmxB2EyFeXRILpgJszd77piagqhSJSapkOC7fU/qaBiwjaS/ew9wYjRM\nJdbH2cUt/peli1lIvo8ZpHGw1mD7mASXiryJL9VHKh6xxRqPS0uxH7Mp0K/xW8+8\njCfrKTAdUFkbaOcQsRct47w1ntwJqMXC37pA9a2Scxmom71fiyFhO54EvLW1u9hu\ngrE5TTDR+nVQRdM4adtnCSF4xo5trk7jlAhqqe7PTWK+9ul5+TuJ9gTD0E0oBl5v\nZ4jDhAusXVPf2F3JDLenrqT6QW/UhxHfzY16xpi4owzaRm8tl0qG5bvCWtd5hjH3\nr2ThngQ75I3HDOz5bXjVOJqvddcCAwEAAaNjMGEwHQYDVR0OBBYEFMLBQJoD9L0k\nHTL3i27ZR4+tTQARMB8GA1UdIwQYMBaAFMLBQJoD9L0kHTL3i27ZR4+tTQARMA8G\nA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEBCwUAA4IC\nAQCHvFx1u36yIn/xqh2imbvYYOUA886qNCw6sniGvXA1Mvpj27tAZXsaSRzBAyAj\nVdpv0D6JbdYPPv7K/Kars2OVgjGv+hLBL6/EnMa4TW77Adx/PyQzxl5/ivlK6CmC\neKzvwu9LBDnCJdrv75vVEL8vILDhtY2M/NnOtwbHoT598hd3pvf1OdYz2j9Q1tki\nn5DCjCDugA+w0Q+ccyzXcEu6MC2MYnPU4wO7CjUnjLXCj0r1b7AFuebN3ehTvvgo\nhbtsHpG3/Z9kS9CTlWh2IpOr3+lgto7jGaqQgRg/GNrzD+3pZBQayAqd7ELWcW1N\n0wNzLHkdGcqMTQFhKf/RNo2S9OUGpCzoyBC+nThgTqt2F99tEMxld6ma7qjUXlyO\nJuCUhe5zwYG5RCCNtZUgJ/BvnWBOGFI2axLamX/FsIQrETZ+x9b5FTb63tMZxtvi\nP9UK0pGAnLZWf2sBhk+isI6FXZNimROu0NoqXkmXKbkHBRMXmTsyamidpaveEX46\nA5Frdi3MWc7yoQhWHbUpjMjM7XebvkFbF9R9gTrsL6aSwEW//5F3ndCYq6oC33bm\nBfqFZ7KbIT0lUPJTTD5+3oeDhjzbsRNe33JqvE+KqLvWJwMeYqb/dCHKnReCRN7w\nOqHVzmx7ssFwHpE2WRvox2QsB3HemqwQKEc5mVWVhU5OyQ==\n-----END CERTIFICATE-----\n"),
				),
			},
			{
				Config: testAccBrocadeSSLCasConfigUpdateTemplate(sslCasConfigName, sslServerKeyName),
				Check: resource.ComposeTestCheckFunc(
					testAccBrocadeVTMSSLCasConfigExists(sslCasConfigName, sslCasConfigResourceName),
					resource.TestCheckResourceAttr(sslCasConfigResourceName, "name", sslCasConfigName),
					resource.TestCheckResourceAttr(sslCasConfigResourceName, "ssl_cas_config", "-----BEGIN CERTIFICATE-----\nMIIF3TCCA8WgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwgYMxCzAJBgNVBAYTAkdC\nMRAwDgYDVQQIDAdFbmdsYW5kMQ8wDQYDVQQHDAZMb25kb24xEDAOBgNVBAoMB0V4\nYW1wbGUxCzAJBgNVBAsMAkVHMRAwDgYDVQQDDAdleGFtcGxlMSAwHgYJKoZIhvcN\nAQkBFhFleGFtcGxlQGxvY2FsaG9zdDAeFw0xNzEwMTkxMDMxMTlaFw0yNzEwMTcx\nMDMxMTlaMHcxCzAJBgNVBAYTAkdCMRAwDgYDVQQIDAdFbmdsYW5kMRAwDgYDVQQK\nDAdFeGFtcGxlMRAwDgYDVQQLDAdleGFtcGxlMRAwDgYDVQQDDAdleGFtcGxlMSAw\nHgYJKoZIhvcNAQkBFhFleGFtcGxlQGxvY2FsaG9zdDCCAiIwDQYJKoZIhvcNAQEB\nBQADggIPADCCAgoCggIBAL1BMw+13lj2dUhp6waarho+MtBIGyrPr+dOposzYLJK\ne5cxNiZ79CPFCKdT012V60bMi3eESfyTmL95UgQqKlj4nn5+CwE3YuVwIgNEnHGi\nPKhh6Og/2HMujU1sHlwmle0PiOJZ5jZxTITHMyK3yIRneIkivQClB4V+Oswa+CLg\n8ITU/XiJbqkep3efS5NSv174HjlJDuXPbi4YSx4tqiggW1eJ3U5woFa+939XK1po\n14ps8FqhpLSuW4qZsKbuQg2d728vZCmRM0sde4noyjLONNVo78b6t8Ku1dSfnfAe\ndxrHQt+O361rbz7NQDiRaiMs2GuyEAn5NQYemhS6dql+SjLZXH2VZHRcUh3bvsyZ\n+I9x7jnfzFC1zru2geBr1WbS2azIJj/Ecz7878tMRyPpK/NpI8R/+eP/k2VWUDc5\nmo1TBnqCZkljXS+c+Y5l1O9Q/JWZR0W3ccuFuR/WwnARBi/Cimk6IZHn65QLIY0f\n0s68xQ38E8UOxGuFFPyEy/K0OTRoRoB42oFBCvqYoNwid2ziB6CalaAqLQw/w7sQ\nzaQKtDnHM8aBKeOySLDOauyO2zsdsRRl/UMVhNqVTAOF6SWKjKru4OTMdEPkL4qL\n5zSoyr5Xrrxo3my2q2f+aaAOaq7gNkYytPv+Igq4Zb6ghA/R/O46jIeBoFoMXzcp\nAgMBAAGjZjBkMB0GA1UdDgQWBBS4DtTxCiZ/xSe7zakg3SAPZ6WW2zAfBgNVHSME\nGDAWgBTCwUCaA/S9JB0y94tu2UePrU0AETASBgNVHRMBAf8ECDAGAQH/AgEAMA4G\nA1UdDwEB/wQEAwIBhjANBgkqhkiG9w0BAQsFAAOCAgEAcVSyrws7O/WdMmDq6VX9\nWVvPYYGncEUsdeFyXerXyCkNnyR+gDZnb6bLgZGSMbzGNn9DCFARAYzg8L+04iLy\nNU7r5VuzAZMrq7pl+qMEMNFGerBq1fRkmEb4BvcfRvyaGedLlf3BpkF7NDOkpIpm\n61rjVEo1zglj8REHP8ng7/kYNLnR2bL8yJBVNEQp9IaNRQtLllq2vpNirhJREjnX\nUWgHlcfDNXvDnbIvebfpbxiub2toQxAtG+DnL3Ug17wkv4ADiYC2esPmW3OmenLf\nRXvdz+XX9UC+AweNm13ewRcUPNnzZiacyUKS8zB12eO8pQIjBesn9xOQGVqnFbWG\nrviYrOvFqhNF2KSrTmEan7Kxio1Kb1Nfpbo/WWI9P7SGLWUTpH3el7X+tdA6ByOs\nxKYB470vN+YgvKNlJZLXiXkZ/awHfWfUdS9xi5oAoB46H/yEoOe8vL2TEAMIWx8p\ncifHYjMhV+SV57SAkpUjw45xJyFn0TBh/NxXUboKn9fefJOIP0kQCBSxzWzVzk4d\n41ijFJ8y7sxLW5cwlt630YQUUBQ+8SSjHdyTlCj+W5CqZyz8xTQ3wxmjuIKqMxw5\nJm3jncDmls1fEVZpdKrrX5RkP/zy4Q/F1z5LkY3VyTxpK8sUyeo20NVBmNToakRr\nX6StyGpgITVFXnNg98fVzQ0=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIF7jCCA9agAwIBAgIJAIqYpYx6bXGmMA0GCSqGSIb3DQEBCwUAMIGDMQswCQYD\nVQQGEwJHQjEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9uMRAwDgYD\nVQQKDAdFeGFtcGxlMQswCQYDVQQLDAJFRzEQMA4GA1UEAwwHZXhhbXBsZTEgMB4G\nCSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhvc3QwHhcNMTcxMDE5MTAyNzMyWhcN\nMzcxMDE0MTAyNzMyWjCBgzELMAkGA1UEBhMCR0IxEDAOBgNVBAgMB0VuZ2xhbmQx\nDzANBgNVBAcMBkxvbmRvbjEQMA4GA1UECgwHRXhhbXBsZTELMAkGA1UECwwCRUcx\nEDAOBgNVBAMMB2V4YW1wbGUxIDAeBgkqhkiG9w0BCQEWEWV4YW1wbGVAbG9jYWxo\nb3N0MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAueVIz2gitbIfux+G\nTlpawaauocuYlEh4VyhOyI78aRpAVhV1YRYuPGJXPji+3xO+0ThkEPDG8sWlliq5\nV6wOcYIZzjGTHYQwkJJxZXGfeOt/J6cio9TORcuLH8FtA8UeR0/HovsJ30YelPB1\nT950FZIOriFk1U3+ty9JF8crqiFOf93TNcldLXCrtKz6KXZeR/GPMkLMHszuMeyJ\ndqtrmWxhOiDwD33K1fpYZKoFJf1CMCNmDD4c0uGDKHUbu7T21JoqiwEImUsWWkyi\nUTDZk17XDbPBXFYUI2v9AimPvpiE+xXpDKGXIUHyTCExgvIiAGZ3neBeEyRrBTdu\nPpKnulXTXmxB2EyFeXRILpgJszd77piagqhSJSapkOC7fU/qaBiwjaS/ew9wYjRM\nJdbH2cUt/peli1lIvo8ZpHGw1mD7mASXiryJL9VHKh6xxRqPS0uxH7Mp0K/xW8+8\njCfrKTAdUFkbaOcQsRct47w1ntwJqMXC37pA9a2Scxmom71fiyFhO54EvLW1u9hu\ngrE5TTDR+nVQRdM4adtnCSF4xo5trk7jlAhqqe7PTWK+9ul5+TuJ9gTD0E0oBl5v\nZ4jDhAusXVPf2F3JDLenrqT6QW/UhxHfzY16xpi4owzaRm8tl0qG5bvCWtd5hjH3\nr2ThngQ75I3HDOz5bXjVOJqvddcCAwEAAaNjMGEwHQYDVR0OBBYEFMLBQJoD9L0k\nHTL3i27ZR4+tTQARMB8GA1UdIwQYMBaAFMLBQJoD9L0kHTL3i27ZR4+tTQARMA8G\nA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEBCwUAA4IC\nAQCHvFx1u36yIn/xqh2imbvYYOUA886qNCw6sniGvXA1Mvpj27tAZXsaSRzBAyAj\nVdpv0D6JbdYPPv7K/Kars2OVgjGv+hLBL6/EnMa4TW77Adx/PyQzxl5/ivlK6CmC\neKzvwu9LBDnCJdrv75vVEL8vILDhtY2M/NnOtwbHoT598hd3pvf1OdYz2j9Q1tki\nn5DCjCDugA+w0Q+ccyzXcEu6MC2MYnPU4wO7CjUnjLXCj0r1b7AFuebN3ehTvvgo\nhbtsHpG3/Z9kS9CTlWh2IpOr3+lgto7jGaqQgRg/GNrzD+3pZBQayAqd7ELWcW1N\n0wNzLHkdGcqMTQFhKf/RNo2S9OUGpCzoyBC+nThgTqt2F99tEMxld6ma7qjUXlyO\nJuCUhe5zwYG5RCCNtZUgJ/BvnWBOGFI2axLamX/FsIQrETZ+x9b5FTb63tMZxtvi\nP9UK0pGAnLZWf2sBhk+isI6FXZNimROu0NoqXkmXKbkHBRMXmTsyamidpaveEX46\nA5Frdi3MWc7yoQhWHbUpjMjM7XebvkFbF9R9gTrsL6aSwEW//5F3ndCYq6oC33bm\nBfqFZ7KbIT0lUPJTTD5+3oeDhjzbsRNe33JqvE+KqLvWJwMeYqb/dCHKnReCRN7w\nOqHVzmx7ssFwHpE2WRvox2QsB3HemqwQKEc5mVWVhU5OyQ==\n-----END CERTIFICATE-----\n-----BEGIN X509 CRL-----\nMIIC8jCB2wIBATANBgkqhkiG9w0BAQsFADB3MQswCQYDVQQGEwJHQjEQMA4GA1UE\nCAwHRW5nbGFuZDEQMA4GA1UECgwHRXhhbXBsZTEQMA4GA1UECwwHZXhhbXBsZTEQ\nMA4GA1UEAwwHZXhhbXBsZTEgMB4GCSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhv\nc3QXDTE3MTAxOTEwMzY0MloXDTE3MTExODEwMzY0MlqgMDAuMB8GA1UdIwQYMBaA\nFLgO1PEKJn/FJ7vNqSDdIA9npZbbMAsGA1UdFAQEAgIQADANBgkqhkiG9w0BAQsF\nAAOCAgEAjQE0vSw7vsN23NVa7lFCFyzozs8vEITqqLSwembIbWR56ZsXyDdh8ZjW\nRl0J2YXnnGi/+Ry8iy4q6LQ6Y9cskO/WHhwTg4cGIA6YFWauUJB42/pE5cMMIhYn\nH7wVnIRUIYjPY+vP/J9Hqu2gZI65WZKCJcHJIWKyJcTlCbkbsPG1WQ+s4063n1p3\n15b6VJhPXVIPfmaoeki7TgWX1GdCb/xTbpcCbNohDHcNjAfGQROYSOtif4U0yaC4\nkaR5q6gLvcEBKksf2cH4jj1dMhKiwy7ozpk9c4j7oBgKDsk5zQR6r/olv7X1pz7O\nnuimdENFXCvG8ZEWrw4mrPYbYH9o/sMVFaxW3XqQDJnP6stNp3myKefOQSDHdDWA\nKl+wDetWNsjETlyH17jaQUu1wk/k50l+MAlT/i5k+/9tyPs7GGOhGwoa2EcbLTjy\n6HIyqa31rF2XeXSyabo8dswf251c+T/quwxdr5GFspmTi2DxE9vBOjK/R6T7IWR+\ngSxKD324sdSH+x+gbFa6EigMM4rFZmUM+RBBFRurKUzWoMiDq6KjVjM+PGdjz9NQ\n9VLwq9oBOaOTFhoinOvgRa9jqG2kiNSo6hhVGwv3I8RJOO5HQ4wQ+/IJz3soZeFI\napO1OHi5/lGGh5EcaCz+g99MvYNjttQnCl1dmKfvIuuXKHG8EOc=\n-----END X509 CRL-----\n"),
				),
			},
		},
	})
}

func testAccBrocadeVTMSSLCasConfigCheckDestroy(state *terraform.State, name string) error {

	config := testAccProvider.Meta().(map[string]interface{})
	client := config["jsonClient"].(*api.Client)

	client.WorkWithConfigurationResources()

	for _, rs := range state.RootModule().Resources {

		if rs.Type != "brocadevtm_ssl_cas_file" {
			continue
		}
		if id, ok := rs.Primary.Attributes["id"]; ok && id != "" {
			return nil
		}
		sslCasList, err := client.GetAllResources("ssl/cas")
		if err != nil {
			return fmt.Errorf("Brocade vTM error occurred while retrieving list of SSL cas configs: %v", err)
		}
		for _, childSSLCasConfig := range sslCasList {
			if childSSLCasConfig["name"] == name {
				return fmt.Errorf("Error: Brocade vTM SSL cas config %s still exists", name)
			}
		}
	}
	return nil
}

func testAccBrocadeVTMSSLCasConfigExists(name, resourceName string) resource.TestCheckFunc {
	return func(state *terraform.State) error {

		config := testAccProvider.Meta().(map[string]interface{})
		client := config["jsonClient"].(*api.Client)

		client.WorkWithConfigurationResources()

		rs, ok := state.RootModule().Resources[resourceName]
		if !ok {
			return fmt.Errorf("\nBrocade vTM SSL cas config %s wasn't found in resources", name)
		}
		if rs.Primary.ID == "" {
			return fmt.Errorf("\nBrocade vTM SSL cas config ID not set for %s in resources", name)
		}

		sslCasConfigList, err := client.GetAllResources("ssl/cas")
		if err != nil {
			return fmt.Errorf("Brocade vTM error occurred while retrieving list of SSL cas configs: %v", err)
		}
		for _, sslCasConfig := range sslCasConfigList {
			if sslCasConfig["name"] == name {
				return nil
			}
		}
		return fmt.Errorf("Brocade vTM SSL cas config %s not found on remote vTM", name)
	}
}

func testAccBrocadeVTMSSLCasConfigNoNameTemplate() string {
	return fmt.Sprintf(`
resource "brocadevtm_ssl_cas_file" "acctest" {
}
`)
}

func testAccBrocadeVTMSSLCasConfigPrepare(sslServerKeyName string) string {
	return fmt.Sprintf(`
resource "brocadevtm_ssl_server_key" "acctest" {
  name = "%s"
  private = <<PRIVATE
-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
PRIVATE
  public = <<PUBLIC
-----BEGIN CERTIFICATE-----
MIIFMjCCAxqgAwIBAgIJAJxSznRdSNTYMA0GCSqGSIb3DQEBCwUAMBoxGDAWBgNV
BAMMD3d3dy5leGFtcGxlLmNvbTAeFw0xNzEwMTkxMTExMjdaFw0xODEwMTkxMTEx
MjdaMBoxGDAWBgNVBAMMD3d3dy5leGFtcGxlLmNvbTCCAiIwDQYJKoZIhvcNAQEB
BQADggIPADCCAgoCggIBAOoKiZY8gLAFj94lhGiZKJHw2uB5m1IDy7ajoVpQemCL
5UkzlH1eo4vgHerAxd9qfP6hj77elorLwqvyoSbNttCAKyzPlWEj+T3akkbL6L2v
1myh05ZM2NE9inuhActBHxLtZTbqzwn8emmLtBZ67q5tCvYGGmbvcRzVgdgqF52j
iRMx3uxqCLe07CjjH52DFzjLuo6+8tvmNtWW0R2ovrb69QTE6TUUmjeGWG/NPAaa
ifflAxVQu5KIFfqv5yWg/zqbJp8sbbAhhxtLpb0P2WR8PfoE+aDYyE6UYbSli+c+
qwUBojdafHqFhDMle9JAhsbReoRTjEKD+XOuTgWQdHBsqGDFK9h6P7+JvRgx+M3c
z3P04eUEfkUX16MvWHxQLz15Lhy8d+KX1vFTVbXLQTRsdn0mAF1DRnz5sWhEhoGB
j2iH3uCmERiY6d7AoZ9ahiu1DAyHcyB6RKMIVYbXBZuMc3Vc0DRN7lsZo2PW3P4E
QtfURVbsDbP0jwcpbjY7VxjLpYCYPvmRWArqHngUiJmf5HJud826Ja8Dny3BhCOA
eGh8+gI3Zn/fl76KgPwROu/W4oKTBpjMU8anV7D+Vdx7VzyTBvDGmg3ZqWYe4AX5
prQTnPRf+w9fCWtRfnFQXlWDB59LCWDZRZoWLqmigM4OX0zsFZfOam5OxwPfoMoX
AgMBAAGjezB5MB0GA1UdDgQWBBSmq2KLwuEebIXdWBBcS3EqXpsSGTBKBgNVHSME
QzBBgBSmq2KLwuEebIXdWBBcS3EqXpsSGaEepBwwGjEYMBYGA1UEAwwPd3d3LmV4
YW1wbGUuY29tggkAnFLOdF1I1NgwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQsF
AAOCAgEAlU8dPThYTZTksn/mSe6pNo+W4o1WPwsrDrsxRi5MONCKHWTLm+fVEo2B
SvKYq1b//tjTBRTG11EdPlGyAe7HRXR1R1gYGG7weanJVKLMOVd65M3uW/1m3i78
N9roek1QJZq7NGKzaYu1glj1uwzXP7wAVVFc8aeF3gqmzPlSkn69t8ReoJMndvQJ
WMOqfCGINOeKxHgPgybzD7m/mx1VWZoRG22UBihWPdta4tJusXwFySUFQMJ4IRY+
pSZVWyX0M2TPnY577hIelHe8qTAQmqF22st/NH3lHs8OjEEv672+M9tJqeOKGflE
7EfpPO0JTaxw0gqnVTgX9f4Jya2V9oPbDZG5V2AKNmmh7/xE+5+68pNmGwAR7grQ
w/5QM9ib8CJ1/mh7sQ8wvsp5lm9dyfPS2XzcEuHm4ecXVGtxPAb/Xc1ZG9Q++Cml
qqHJ1WMaZhUItrY6nnouL624UqW5URHlv6A+QE1+v3VVOK6isYuQIye/J6jaczLd
xiuqy6iHiMK9kujKcp2B3gknUx0keyZmHhz0yayPnX9tE/GtDwGTaoG7PPay4g6l
j6rxn1mSCSliJnN1FO1Un6EbN382Ibl2BjkQJ4ZOrd9gH+i/QOVrZAaFiTYkK6EU
r5Be6q4Gl90vQARuisBXRa5wAGcpGWPGt0lBz6UZ2rz4Rmn5SLY=
-----END CERTIFICATE-----
PUBLIC
  request = <<REQUEST
-----BEGIN CERTIFICATE REQUEST-----
MIIEpDCCAowCAQAwGjEYMBYGA1UEAwwPd3d3LmV4YW1wbGUuY29tMIICIjANBgkq
hkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA6gqJljyAsAWP3iWEaJkokfDa4HmbUgPL
tqOhWlB6YIvlSTOUfV6ji+Ad6sDF32p8/qGPvt6WisvCq/KhJs220IArLM+VYSP5
PdqSRsvova/WbKHTlkzY0T2Ke6EBy0EfEu1lNurPCfx6aYu0Fnrurm0K9gYaZu9x
HNWB2CoXnaOJEzHe7GoIt7TsKOMfnYMXOMu6jr7y2+Y21ZbRHai+tvr1BMTpNRSa
N4ZYb808BpqJ9+UDFVC7kogV+q/nJaD/OpsmnyxtsCGHG0ulvQ/ZZHw9+gT5oNjI
TpRhtKWL5z6rBQGiN1p8eoWEMyV70kCGxtF6hFOMQoP5c65OBZB0cGyoYMUr2Ho/
v4m9GDH4zdzPc/Th5QR+RRfXoy9YfFAvPXkuHLx34pfW8VNVtctBNGx2fSYAXUNG
fPmxaESGgYGPaIfe4KYRGJjp3sChn1qGK7UMDIdzIHpEowhVhtcFm4xzdVzQNE3u
WxmjY9bc/gRC19RFVuwNs/SPByluNjtXGMulgJg++ZFYCuoeeBSImZ/kcm53zbol
rwOfLcGEI4B4aHz6Ajdmf9+XvoqA/BE679bigpMGmMxTxqdXsP5V3HtXPJMG8Maa
DdmpZh7gBfmmtBOc9F/7D18Ja1F+cVBeVYMHn0sJYNlFmhYuqaKAzg5fTOwVl85q
bk7HA9+gyhcCAwEAAaBFMEMGCSqGSIb3DQEJDjE2MDQwCQYDVR0TBAIwADALBgNV
HQ8EBAMCBeAwGgYDVR0RBBMwEYIPd3d3LmV4YW1wbGUuY29tMA0GCSqGSIb3DQEB
CwUAA4ICAQBXMs1T/C+VHoKksD2beF9YwY9FMpQDP2hMeKI57eFjSdG+ce71n1DH
U7/+QBbdkEMwZLI/jDisFHpttWSHXJyk+pEd17CpfHaKggI8co3JHM+/2KZg0KVV
WVRKKh5jNqJBiKJ/5wxrIdjp2QujPNEMS/e09I0i8qNWMrXT83siVEZ1m81KyrWy
bUFEiiIKfCmvIUAALAtLBmEuLWFKx1IMEi1r7UOQb+nFXAyCypL3uTWOVjiFxmAu
BgJpB1I11NgyR2MEFGZkjs9YLMP0+9Mzjb5pXqeIchDNq8JPI1TVlA9x8H2aT0Mc
I2BlAm9BeG/RT/f/WxupGMXo1nc+bEfDJdtSe7pxC3U1oqyx4Keegvl9/YYzbHbx
FPGZbkpUNftsaq39FP4C+lowjW0hDjXkwZkLbJbd9kTWYF1XBGQKNSK+K8Q9JJeA
pSJDYH16FwN0Q5vpryVADTLB30eghWMkolMffsW7OvR9kRzihdZVuRXET02mIQ7f
QTILE7A8uce94HsyL9bhN2VgQBFK5wFOQAGXopkVgEc/oKFbYtIXqjHcQ8m4PGEz
vh8UkYmmg55dgHjutn7YAv7TVheLE1qlaLNhCWXHhlotF11y77T7+jztKk9GuiRh
nwWVSX+F01S4d1GJ0iQIVFv8JRbTjSUV0A0vBnXhfV90R2rzIf7Wpw==
REQUEST
}
`, sslServerKeyName)
}

func testAccBrocadeSSLCasConfigCreateTemplate(sslCasConfigName, sslServerKeyName string) string {
	return fmt.Sprintf(`
resource "brocadevtm_ssl_cas_file" "acctest" {
  name = "%s"
  ssl_cas_config = <<SSL_CAS_CONFIG
-----BEGIN CERTIFICATE-----
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
X6StyGpgITVFXnNg98fVzQ0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIF7jCCA9agAwIBAgIJAIqYpYx6bXGmMA0GCSqGSIb3DQEBCwUAMIGDMQswCQYD
VQQGEwJHQjEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9uMRAwDgYD
VQQKDAdFeGFtcGxlMQswCQYDVQQLDAJFRzEQMA4GA1UEAwwHZXhhbXBsZTEgMB4G
CSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhvc3QwHhcNMTcxMDE5MTAyNzMyWhcN
MzcxMDE0MTAyNzMyWjCBgzELMAkGA1UEBhMCR0IxEDAOBgNVBAgMB0VuZ2xhbmQx
DzANBgNVBAcMBkxvbmRvbjEQMA4GA1UECgwHRXhhbXBsZTELMAkGA1UECwwCRUcx
EDAOBgNVBAMMB2V4YW1wbGUxIDAeBgkqhkiG9w0BCQEWEWV4YW1wbGVAbG9jYWxo
b3N0MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAueVIz2gitbIfux+G
TlpawaauocuYlEh4VyhOyI78aRpAVhV1YRYuPGJXPji+3xO+0ThkEPDG8sWlliq5
V6wOcYIZzjGTHYQwkJJxZXGfeOt/J6cio9TORcuLH8FtA8UeR0/HovsJ30YelPB1
T950FZIOriFk1U3+ty9JF8crqiFOf93TNcldLXCrtKz6KXZeR/GPMkLMHszuMeyJ
dqtrmWxhOiDwD33K1fpYZKoFJf1CMCNmDD4c0uGDKHUbu7T21JoqiwEImUsWWkyi
UTDZk17XDbPBXFYUI2v9AimPvpiE+xXpDKGXIUHyTCExgvIiAGZ3neBeEyRrBTdu
PpKnulXTXmxB2EyFeXRILpgJszd77piagqhSJSapkOC7fU/qaBiwjaS/ew9wYjRM
JdbH2cUt/peli1lIvo8ZpHGw1mD7mASXiryJL9VHKh6xxRqPS0uxH7Mp0K/xW8+8
jCfrKTAdUFkbaOcQsRct47w1ntwJqMXC37pA9a2Scxmom71fiyFhO54EvLW1u9hu
grE5TTDR+nVQRdM4adtnCSF4xo5trk7jlAhqqe7PTWK+9ul5+TuJ9gTD0E0oBl5v
Z4jDhAusXVPf2F3JDLenrqT6QW/UhxHfzY16xpi4owzaRm8tl0qG5bvCWtd5hjH3
r2ThngQ75I3HDOz5bXjVOJqvddcCAwEAAaNjMGEwHQYDVR0OBBYEFMLBQJoD9L0k
HTL3i27ZR4+tTQARMB8GA1UdIwQYMBaAFMLBQJoD9L0kHTL3i27ZR4+tTQARMA8G
A1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEBCwUAA4IC
AQCHvFx1u36yIn/xqh2imbvYYOUA886qNCw6sniGvXA1Mvpj27tAZXsaSRzBAyAj
Vdpv0D6JbdYPPv7K/Kars2OVgjGv+hLBL6/EnMa4TW77Adx/PyQzxl5/ivlK6CmC
eKzvwu9LBDnCJdrv75vVEL8vILDhtY2M/NnOtwbHoT598hd3pvf1OdYz2j9Q1tki
n5DCjCDugA+w0Q+ccyzXcEu6MC2MYnPU4wO7CjUnjLXCj0r1b7AFuebN3ehTvvgo
hbtsHpG3/Z9kS9CTlWh2IpOr3+lgto7jGaqQgRg/GNrzD+3pZBQayAqd7ELWcW1N
0wNzLHkdGcqMTQFhKf/RNo2S9OUGpCzoyBC+nThgTqt2F99tEMxld6ma7qjUXlyO
JuCUhe5zwYG5RCCNtZUgJ/BvnWBOGFI2axLamX/FsIQrETZ+x9b5FTb63tMZxtvi
P9UK0pGAnLZWf2sBhk+isI6FXZNimROu0NoqXkmXKbkHBRMXmTsyamidpaveEX46
A5Frdi3MWc7yoQhWHbUpjMjM7XebvkFbF9R9gTrsL6aSwEW//5F3ndCYq6oC33bm
BfqFZ7KbIT0lUPJTTD5+3oeDhjzbsRNe33JqvE+KqLvWJwMeYqb/dCHKnReCRN7w
OqHVzmx7ssFwHpE2WRvox2QsB3HemqwQKEc5mVWVhU5OyQ==
-----END CERTIFICATE-----
SSL_CAS_CONFIG
  depends_on = ["brocadevtm_ssl_server_key.acctest"]
}
%s
`, sslCasConfigName, testAccBrocadeVTMSSLCasConfigPrepare(sslServerKeyName))
}

func testAccBrocadeSSLCasConfigUpdateTemplate(sslCasConfigName, sslServerKeyName string) string {
	return fmt.Sprintf(`
resource "brocadevtm_ssl_cas_file" "acctest" {
  name = "%s"
  ssl_cas_config = <<SSL_CAS_CONFIG
-----BEGIN CERTIFICATE-----
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
X6StyGpgITVFXnNg98fVzQ0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIF7jCCA9agAwIBAgIJAIqYpYx6bXGmMA0GCSqGSIb3DQEBCwUAMIGDMQswCQYD
VQQGEwJHQjEQMA4GA1UECAwHRW5nbGFuZDEPMA0GA1UEBwwGTG9uZG9uMRAwDgYD
VQQKDAdFeGFtcGxlMQswCQYDVQQLDAJFRzEQMA4GA1UEAwwHZXhhbXBsZTEgMB4G
CSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhvc3QwHhcNMTcxMDE5MTAyNzMyWhcN
MzcxMDE0MTAyNzMyWjCBgzELMAkGA1UEBhMCR0IxEDAOBgNVBAgMB0VuZ2xhbmQx
DzANBgNVBAcMBkxvbmRvbjEQMA4GA1UECgwHRXhhbXBsZTELMAkGA1UECwwCRUcx
EDAOBgNVBAMMB2V4YW1wbGUxIDAeBgkqhkiG9w0BCQEWEWV4YW1wbGVAbG9jYWxo
b3N0MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAueVIz2gitbIfux+G
TlpawaauocuYlEh4VyhOyI78aRpAVhV1YRYuPGJXPji+3xO+0ThkEPDG8sWlliq5
V6wOcYIZzjGTHYQwkJJxZXGfeOt/J6cio9TORcuLH8FtA8UeR0/HovsJ30YelPB1
T950FZIOriFk1U3+ty9JF8crqiFOf93TNcldLXCrtKz6KXZeR/GPMkLMHszuMeyJ
dqtrmWxhOiDwD33K1fpYZKoFJf1CMCNmDD4c0uGDKHUbu7T21JoqiwEImUsWWkyi
UTDZk17XDbPBXFYUI2v9AimPvpiE+xXpDKGXIUHyTCExgvIiAGZ3neBeEyRrBTdu
PpKnulXTXmxB2EyFeXRILpgJszd77piagqhSJSapkOC7fU/qaBiwjaS/ew9wYjRM
JdbH2cUt/peli1lIvo8ZpHGw1mD7mASXiryJL9VHKh6xxRqPS0uxH7Mp0K/xW8+8
jCfrKTAdUFkbaOcQsRct47w1ntwJqMXC37pA9a2Scxmom71fiyFhO54EvLW1u9hu
grE5TTDR+nVQRdM4adtnCSF4xo5trk7jlAhqqe7PTWK+9ul5+TuJ9gTD0E0oBl5v
Z4jDhAusXVPf2F3JDLenrqT6QW/UhxHfzY16xpi4owzaRm8tl0qG5bvCWtd5hjH3
r2ThngQ75I3HDOz5bXjVOJqvddcCAwEAAaNjMGEwHQYDVR0OBBYEFMLBQJoD9L0k
HTL3i27ZR4+tTQARMB8GA1UdIwQYMBaAFMLBQJoD9L0kHTL3i27ZR4+tTQARMA8G
A1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEBCwUAA4IC
AQCHvFx1u36yIn/xqh2imbvYYOUA886qNCw6sniGvXA1Mvpj27tAZXsaSRzBAyAj
Vdpv0D6JbdYPPv7K/Kars2OVgjGv+hLBL6/EnMa4TW77Adx/PyQzxl5/ivlK6CmC
eKzvwu9LBDnCJdrv75vVEL8vILDhtY2M/NnOtwbHoT598hd3pvf1OdYz2j9Q1tki
n5DCjCDugA+w0Q+ccyzXcEu6MC2MYnPU4wO7CjUnjLXCj0r1b7AFuebN3ehTvvgo
hbtsHpG3/Z9kS9CTlWh2IpOr3+lgto7jGaqQgRg/GNrzD+3pZBQayAqd7ELWcW1N
0wNzLHkdGcqMTQFhKf/RNo2S9OUGpCzoyBC+nThgTqt2F99tEMxld6ma7qjUXlyO
JuCUhe5zwYG5RCCNtZUgJ/BvnWBOGFI2axLamX/FsIQrETZ+x9b5FTb63tMZxtvi
P9UK0pGAnLZWf2sBhk+isI6FXZNimROu0NoqXkmXKbkHBRMXmTsyamidpaveEX46
A5Frdi3MWc7yoQhWHbUpjMjM7XebvkFbF9R9gTrsL6aSwEW//5F3ndCYq6oC33bm
BfqFZ7KbIT0lUPJTTD5+3oeDhjzbsRNe33JqvE+KqLvWJwMeYqb/dCHKnReCRN7w
OqHVzmx7ssFwHpE2WRvox2QsB3HemqwQKEc5mVWVhU5OyQ==
-----END CERTIFICATE-----
-----BEGIN X509 CRL-----
MIIC8jCB2wIBATANBgkqhkiG9w0BAQsFADB3MQswCQYDVQQGEwJHQjEQMA4GA1UE
CAwHRW5nbGFuZDEQMA4GA1UECgwHRXhhbXBsZTEQMA4GA1UECwwHZXhhbXBsZTEQ
MA4GA1UEAwwHZXhhbXBsZTEgMB4GCSqGSIb3DQEJARYRZXhhbXBsZUBsb2NhbGhv
c3QXDTE3MTAxOTEwMzY0MloXDTE3MTExODEwMzY0MlqgMDAuMB8GA1UdIwQYMBaA
FLgO1PEKJn/FJ7vNqSDdIA9npZbbMAsGA1UdFAQEAgIQADANBgkqhkiG9w0BAQsF
AAOCAgEAjQE0vSw7vsN23NVa7lFCFyzozs8vEITqqLSwembIbWR56ZsXyDdh8ZjW
Rl0J2YXnnGi/+Ry8iy4q6LQ6Y9cskO/WHhwTg4cGIA6YFWauUJB42/pE5cMMIhYn
H7wVnIRUIYjPY+vP/J9Hqu2gZI65WZKCJcHJIWKyJcTlCbkbsPG1WQ+s4063n1p3
15b6VJhPXVIPfmaoeki7TgWX1GdCb/xTbpcCbNohDHcNjAfGQROYSOtif4U0yaC4
kaR5q6gLvcEBKksf2cH4jj1dMhKiwy7ozpk9c4j7oBgKDsk5zQR6r/olv7X1pz7O
nuimdENFXCvG8ZEWrw4mrPYbYH9o/sMVFaxW3XqQDJnP6stNp3myKefOQSDHdDWA
Kl+wDetWNsjETlyH17jaQUu1wk/k50l+MAlT/i5k+/9tyPs7GGOhGwoa2EcbLTjy
6HIyqa31rF2XeXSyabo8dswf251c+T/quwxdr5GFspmTi2DxE9vBOjK/R6T7IWR+
gSxKD324sdSH+x+gbFa6EigMM4rFZmUM+RBBFRurKUzWoMiDq6KjVjM+PGdjz9NQ
9VLwq9oBOaOTFhoinOvgRa9jqG2kiNSo6hhVGwv3I8RJOO5HQ4wQ+/IJz3soZeFI
apO1OHi5/lGGh5EcaCz+g99MvYNjttQnCl1dmKfvIuuXKHG8EOc=
-----END X509 CRL-----
SSL_CAS_CONFIG
  depends_on = ["brocadevtm_ssl_server_key.acctest"]
}
%s
`, sslCasConfigName, testAccBrocadeVTMSSLCasConfigPrepare(sslServerKeyName))
}
